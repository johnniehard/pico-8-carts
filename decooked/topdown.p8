pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
//hello again
x=0 y=0 spd=1 dirx=0 diry=0
flipx=false flipy=false
pspr=1 lastbtn=1 p={}
mval=2
ldirx=1 ldiry=1
seltile={x=-1,y=-1}

function _update()
	if(btn(0)) and diry==0 then dirx=-1 lastbtn=0
	elseif(btn(1)) and diry==0 then dirx=1 lastbtn=1
	else dirx=0 end
	
	if(btn(2)) and dirx==0 then diry=-1 lastbtn=2
	elseif(btn(3)) and dirx==0 then diry=1 lastbtn=3
	else	diry=0 end

	if dirx != 0 then ldirx = dirx end
	if diry != 0 then ldiry = diry end
	
	x+=spd*dirx
	y+=spd*diry
	if(dirx<0) then flipx=true
	elseif(dirx>0) then flipx=false
	elseif(diry<0) then flipy=false
	elseif(diry>0) then flipy=true
	end
	
	if(dirx!=0) then pspr=1
	elseif(diry!=0) then pspr=2
	end

	p=pointerloc()
	-- mval=mget((p.x+3*ldirx)/8,(p.y+3*ldiry)/8)
	mval=mget(p.x/8,p.y/8)
	if mval != 0 then seltile={x=p.x-p.x%8,y=p.y-p.y%8}
	else seltile={x=-10,y=-10} end
end

function pointerloc()
	local x=x local y=y
	if lastbtn==0 then x-=8 end
	if lastbtn==1 then x+=8 end
	if lastbtn==2 then y-=8 end
	if lastbtn==3 then y+=8 end
	return {x=x,y=y}
end

function _draw()
	cls()
	-- camera(x, y)
	map(0,0,0,0,16,16)
	-- camera()
	-- spr(pspr,64-4,64-4,1,1,flipx,flipy)
	spr(pspr,x-4,y-4,1,1,flipx,flipy)
	circfill()
	-- circfill(p.x,p.y,1,3)
	rect(p.x-4,p.y-4,p.x-4+7,p.y-4+7,12)
	-- rect(seltile.x-4,seltile.y-4,seltile.x-4+7,seltile.y-4+7,10)
	rect(seltile.x,seltile.y,seltile.x+7,seltile.y+7,10)

	print(mval,0,0,15)
	print(seltile.x,0, 8, 15)
	print(seltile.y,0, 16, 15)
end
__gfx__
00000000005566000088880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008888000088880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700088888886888888600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000088888886888888600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000088888885888888500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700088888885888888500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000008888000088880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000005566000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000bbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000166116160000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0011111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0101000010050100500d0501a0501c050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
